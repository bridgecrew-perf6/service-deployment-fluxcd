serviceName: malware-resolver
  components:
    malware-resolver:
      image: customer-registry.tmloc.com/tm/afs-malware-resolver:1-idp
      command: [ "python3", "src/malware_resolver/app.py", "--resolver" ]
      livenessProbe:
        type: file
        file: /tmp/liveness.tmp
      env:
        TZ: Europe/Prague
      redisStreamsClaim: rdc-redis-cluster
      postgresqlDatabaseClaim: afs-malware-resolver

    malware-consumer:
      image: customer-registry.tmloc.com/tm/afs-malware-resolver:1-idp
      command: [ "python3", "src/malware_resolver/app.py", "--consumer" ]
      livenessProbe:
        type: file
        file: /tmp/liveness.tmp
      env:
        TZ: Europe/Prague
      redisStreamsClaim: rdc-redis-cluster
      postgresqlDatabaseClaim: afs-malware-resolver

  dbMigrations:
    image: customer-registry.tmloc.com/tm/afs-malware-resolver:1-idp
    redisStreamsClaim: rdc-redis-cluster
    postgresqlDatabaseClaim: afs-malware-resolver

  resources:
    postgresqlDatabaseClaims:
      afs-malware-resolver:
        name: afs-malware-resolver
        configMap: afs-malware-resolver-postgres
        secretName: afs-malware-resolver-postgres
    redisStreamsClaims:
      rdc-redis-cluster: